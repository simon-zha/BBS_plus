# BBS+ Threshold Signature Implementation

ä¸€ä¸ªåŸºäºæ¤­åœ†æ›²çº¿å¯†ç å­¦çš„BBS+é˜ˆå€¼ç­¾åç®—æ³•å®ç°ï¼Œæ”¯æŒåŸºç¡€ç­¾åã€é˜ˆå€¼ç­¾åå’Œç›²ç­¾ååŠŸèƒ½ã€‚

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

- **åŸºç¡€BBS+ç­¾å**: æ”¯æŒå‘é‡æ¶ˆæ¯çš„æ•°å­—ç­¾å
- **é˜ˆå€¼ç­¾å**: åˆ†å¸ƒå¼ç­¾åï¼Œéœ€è¦tä¸ªå‚ä¸æ–¹åä½œç”Ÿæˆæœ‰æ•ˆç­¾å  
- **ç›²ç­¾å**: å¼±éƒ¨åˆ†ç›²ç­¾åï¼Œä¿æŠ¤æ¶ˆæ¯éšç§
- **ç½‘ç»œé€šä¿¡**: åŸºäºTCP/IPçš„å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„
- **æ¤­åœ†æ›²çº¿**: ä½¿ç”¨BLS12-381æ›²çº¿å’ŒåŒçº¿æ€§é…å¯¹
- **æ€§èƒ½æµ‹è¯•**: å†…ç½®åŸºå‡†æµ‹è¯•å·¥å…·

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
new_bbs_plus/
â”œâ”€â”€ bbs/                    # æ ¸å¿ƒç®—æ³•å®ç°
â”‚   â”œâ”€â”€ bbs_plus.py        # BBS+ç­¾åç®—æ³•
â”‚   â”œâ”€â”€ threshold.py       # é˜ˆå€¼ç­¾åå’Œç›²ç­¾å
â”‚   â”œâ”€â”€ curve.py           # æ¤­åœ†æ›²çº¿è¿ç®—
â”‚   â””â”€â”€ commitment.py      # æ‰¿è¯ºæœºåˆ¶
â”œâ”€â”€ test/                   # æµ‹è¯•å’Œç¤ºä¾‹
â”‚   â”œâ”€â”€ server.py          # é˜ˆå€¼ç­¾åæœåŠ¡å™¨
â”‚   â””â”€â”€ client.py          # æµ‹è¯•å®¢æˆ·ç«¯
â”œâ”€â”€ benchmark/              # æ€§èƒ½æµ‹è¯•
â”‚   â””â”€â”€ benchmark.py       # åŸºå‡†æµ‹è¯•å·¥å…·
â””â”€â”€ README.md              # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”§ å®‰è£…è¦æ±‚

### ä¾èµ–åº“

```bash
pip install py_ecc
```

### Pythonç‰ˆæœ¬
- Python 3.7+

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€æµ‹è¯•

è¿è¡Œæœ¬åœ°æµ‹è¯•éªŒè¯æ‰€æœ‰åŠŸèƒ½ï¼š

```bash
cd new_bbs_plus
python test/simple_local_test.py
```

### 2. é˜ˆå€¼ç­¾åç½‘ç»œæµ‹è¯•

å¯åŠ¨4ä¸ªæœåŠ¡å™¨å®ä¾‹ï¼š

```bash
# ç»ˆç«¯1
python test/server.py --id 1 --port 8001

# ç»ˆç«¯2  
python test/server.py --id 2 --port 8002

# ç»ˆç«¯3
python test/server.py --id 3 --port 8003

# ç»ˆç«¯4
python test/server.py --id 4 --port 8004
```

è¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•ï¼š

```bash
# ç»ˆç«¯5
python test/client.py
```

### 3. æ€§èƒ½åŸºå‡†æµ‹è¯•

```bash
python benchmark/benchmark.py
```

## ğŸ“Š æµ‹è¯•æµç¨‹

å®¢æˆ·ç«¯ä¼šä¾æ¬¡æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **ç³»ç»Ÿåˆå§‹åŒ–**: è®¾ç½®å…¬é’¥å’Œå¯†é’¥åˆ†äº«
2. **åŸºç¡€é˜ˆå€¼ç­¾å**: ç”Ÿæˆå’ŒéªŒè¯é˜ˆå€¼ç­¾å
3. **ç®€åŒ–ç›²ç­¾å**: æµ‹è¯•åŸºæœ¬ç›²ç­¾åæµç¨‹
4. **æ­£å¼ç›²ç­¾å**: ä½¿ç”¨å®Œæ•´çš„è®ºæ–‡åè®®
5. **ç­¾åéªŒè¯**: éªŒè¯æ‰€æœ‰ç”Ÿæˆçš„ç­¾å

### é¢„æœŸè¾“å‡º

```
BBS+ Threshold Signature Test
Ports: [8001, 8002, 8003, 8004], Threshold: 3, Messages: [111, 222, 333]

--- Init ---
Setup server 8001
Got public key from 8001
Server 8001 OK
...
System ready (4/4)

--- Sign ---
Signing: [111, 222, 333]
Getting partial sig from 8001
Got partial from 8001
...
Signature ready

--- Verify ---
Verifying...
Verify: PASS

--- Blind Signature Test ---
Testing blind signature...
Blind signature generated
Blind signature verify: PASS

--- Formal Blind Signature Test ---
Testing FORMAL blind signature...
Formal blind signature generated
Formal blind signature verify: PASS

--- Result ---
SUCCESS: Threshold signature works!
SUCCESS: Blind signature also works!
SUCCESS: Formal blind signature works!
```

## ğŸ”¬ æŠ€æœ¯ç»†èŠ‚

### ç®—æ³•å‚æ•°

- **æ¤­åœ†æ›²çº¿**: BLS12-381
- **å‚ä¸æ–¹æ•°é‡**: n = 4
- **é˜ˆå€¼**: t = 3  
- **æ¶ˆæ¯é•¿åº¦**: æ”¯æŒä»»æ„é•¿åº¦çš„å‘é‡æ¶ˆæ¯

### å¯†é’¥åˆ†äº«

ä½¿ç”¨Shamirç§˜å¯†åˆ†äº«æ–¹æ¡ˆï¼š
- ç§˜å¯†å¯†é’¥åˆ†å‰²ä¸ºnä»½
- ä»»æ„tä»½å¯é‡æ„åŸå§‹å¯†é’¥
- æ‹‰æ ¼æœ—æ—¥æ’å€¼é‡æ„

### ç›²ç­¾åæœºåˆ¶

æ”¯æŒå¼±éƒ¨åˆ†ç›²ç­¾åï¼š
- **å…¬å¼€ä¿¡æ¯**: ç­¾åæ–¹å¯è§
- **ç§æœ‰ä¿¡æ¯**: ç»è¿‡ç›²åŒ–ä¿æŠ¤
- **ç›²åŒ–å‚æ•°**: `blinding_nonce_e`, `blinding_nonce_s`

### ç½‘ç»œåè®®

åŸºäºJSONçš„ç®€å•åè®®ï¼š

```json
// ç³»ç»Ÿåˆå§‹åŒ–
{"type": "setup", "message_length": 3, "threshold": 3}

// é˜ˆå€¼ç­¾å
{"type": "sign", "messages": [111, 222, 333], "threshold": 3}

// ç­¾åç»„åˆ
{"type": "combine", "partial_signatures": [...], "messages": [...]}

// ç›²ç­¾å
{"type": "blind_sign", "messages": [...], "public_info": [...], "private_info": [...]}
```

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

åŸºå‡†æµ‹è¯•åŒ…å«ï¼š

1. **æ¤­åœ†æ›²çº¿è¿ç®—**
   - G1æ ‡é‡ä¹˜æ³•
   - G2æ ‡é‡ä¹˜æ³•  
   - åŒçº¿æ€§é…å¯¹

2. **å¯†é’¥ç”Ÿæˆ**
   - ä¸åŒæ¶ˆæ¯é•¿åº¦çš„setupæ—¶é—´

3. **ç­¾åç”Ÿæˆ**
   - å®Œæ•´é˜ˆå€¼ç­¾åæµç¨‹
   - å¤šè½®é€šä¿¡æ—¶é—´

4. **ç­¾åéªŒè¯**
   - å•ç­¾åéªŒè¯
   - æ‰¹é‡éªŒè¯

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **æŠ—ä¼ªé€ **: åŸºäºåŒçº¿æ€§é…å¯¹çš„å›°éš¾é—®é¢˜
- **é˜ˆå€¼å®‰å…¨**: éœ€è¦tä¸ªè¯šå®å‚ä¸æ–¹
- **ç›²ç­¾åéšç§**: ç§æœ‰æ¶ˆæ¯å¯¹ç­¾åæ–¹ä¸å¯è§
- **é›¶çŸ¥è¯†**: æ‰¿è¯ºæœºåˆ¶ä¿æŠ¤ä¸­é—´å€¼

## ğŸ“š æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒç®—æ³•

- **`bbs/bbs_plus.py`**: BBS+ç­¾åçš„åŸºæœ¬å®ç°
  - `gen()`: å¯†é’¥ç”Ÿæˆ
  - `sign()`: ç­¾åç”Ÿæˆ
  - `verify()`: ç­¾åéªŒè¯

- **`bbs/threshold.py`**: é˜ˆå€¼å’Œç›²ç­¾åå®ç°
  - `ThresholdBBSPlus`: ç®€åŒ–é˜ˆå€¼ç­¾å
  - `FormalThresholdBBSPlus`: å®Œæ•´è®ºæ–‡åè®®
  - `WeakPartiallyBlindSigning`: ç›²ç­¾åæœºåˆ¶

- **`bbs/curve.py`**: æ¤­åœ†æ›²çº¿è¿ç®—
  - BLS12-381æ›²çº¿æ“ä½œ
  - ç‚¹åºåˆ—åŒ–/ååºåˆ—åŒ–
  - åŒçº¿æ€§é…å¯¹

### ç½‘ç»œç»„ä»¶

- **`test/server.py`**: é˜ˆå€¼ç­¾åæœåŠ¡å™¨
  - æ”¯æŒå¤šç§ç­¾ååè®®
  - å¤šçº¿ç¨‹å¤„ç†
  - ç¡®å®šæ€§setup

- **`test/client.py`**: æµ‹è¯•å®¢æˆ·ç«¯
  - å®Œæ•´æµ‹è¯•æµç¨‹
  - å¤šç§ç­¾åæµ‹è¯•
  - é”™è¯¯å¤„ç†

## ğŸ› ï¸ å¼€å‘è¯´æ˜

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨`bbs/`ç›®å½•æ·»åŠ æ–°ç®—æ³•
2. åœ¨`test/`ç›®å½•æ·»åŠ æµ‹è¯•
3. æ›´æ–°æœåŠ¡å™¨è¯·æ±‚å¤„ç†
4. æ·»åŠ å®¢æˆ·ç«¯è°ƒç”¨æ¥å£

### è°ƒè¯•å»ºè®®

- ä½¿ç”¨`simple_local_test.py`å¿«é€ŸéªŒè¯ç®—æ³•
- æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—æ’æŸ¥ç½‘ç»œé—®é¢˜
- å¯ç”¨è¯¦ç»†è¾“å‡ºè°ƒè¯•åè®®æµç¨‹

## ğŸ“– å‚è€ƒæ–‡çŒ®

- BBS+ Signatures: [åŸå§‹è®ºæ–‡é“¾æ¥]
- é˜ˆå€¼ç­¾ååè®®: [åè®®4.1æè¿°]
- BLS12-381æ›²çº¿: [æ›²çº¿è§„èŒƒ]

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚